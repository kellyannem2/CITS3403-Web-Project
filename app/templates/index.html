<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>FitTrack Dashboard</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>


  {% include 'header.html' %}

  <main>
    <div class="columns">

      <!-- Leaderboard Column -->
      <div class="column">
        <div class="column-header">
          <h2 onclick="location.href='{{ url_for('leaderboard') }}'" style="cursor:pointer;">Leaderboard</h2>
        </div>
        <p class="subheading">weekly average</p>
        <div id="scoreboard-section">
          {% include 'partials/scoreboard.html' %}
        </div>
        
        <button onclick="refreshScoreboard()">Refresh Scoreboard</button>
        
        <a href="{{ url_for('leaderboard') }}" class="btn-link">View More</a>
      </div>

      <!-- Exercise Log Column -->
      <div class="column">
        <div class="column-header">
          <h2 onclick="location.href='{{ url_for('exercise_log') }}'" style="cursor:pointer;">Exercise Log</h2>
          <button class="add-btn" title="Add an Exercise">+</button>
        </div>
        <table>
          <thead>
            <tr>
              <th>Exercise</th>
              <th>Duration</th>
              <th>Calories</th>
            </tr>
          </thead>
          <tbody>
            {% for log in exercise_log%}
            <tr>
              <td>{{ log.exercise.name }}</td>
              <td>{{ log.duration_minutes }} min</td>
              <td>{{ log.calories_burned }}</td>
            </tr>
            {% else %}
            <tr>
              <td colspan="3">No logs yet</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        <div class="total-summary">
        <span>Total: {{ user_total_calories_burnt }} cal</span>
        </div>
        <h3>Weekly Calories Burned</h3>
        <canvas id="dashboardExerciseChart" width="400" height="200"></canvas>
        <a href="{{ url_for('exercise_log') }}" class="btn-link">View More</a>
      </div>

      <!-- Calorie Counter Column -->
      <div class="column">
        <div class="column-header">
          <h2 onclick="location.href='{{ url_for('calorie_counter') }}'" style="cursor:pointer;">Calorie Counter</h2>
          <button class="add-btn" title="Add a Meal">+</button>
        </div>
        <table>
          <thead>
            <tr>
              <th>Meal</th>
              <th>Calories</th>
            </tr>
          </thead>
          <tbody>
              {% for log in meal_logs%}
              <tr>
                <td>{{ log.date }}</td>
                <td>{{ log.meal.name }}</td>
                <td>{{ log.meal.calories }}</td>
              </tr>
              {% else %}
              <tr>
                <td colspan="3">No logs yet</td>
              </tr>
              {% endfor %}
          </tbody>
        </table>
        <div class="total-summary"><span>Total: 1,650</span></div>
        <h3>Weekly Calorie Intake</h3>
        <canvas id="dashboardCalorieChart" width="400" height="200"></canvas>
        <a href="{{ url_for('calorie_counter') }}" class="btn-link">View More</a>
      </div>

    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // Dashboard Exercise Log Chart
    const ctxDashboardExercise = document.getElementById('dashboardExerciseChart').getContext('2d');
    new Chart(ctxDashboardExercise, {
      type: 'bar',
      data: {
        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
        datasets: [{
          label: 'Calories Burned',
          data: [300, 400, 350, 500, 450, 600, 400],
          backgroundColor: 'rgba(75, 192, 192, 0.2)',
          borderColor: 'rgba(75, 192, 192, 1)',
          borderWidth: 1
        }]
      },
      options: { scales: { y: { beginAtZero: true } } }
    });

    // Dashboard Calorie Counter Chart
    const ctxDashboardCalorie = document.getElementById('dashboardCalorieChart').getContext('2d');
    new Chart(ctxDashboardCalorie, {
      type: 'line',
      data: {
        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
        datasets: [{
          label: 'Calorie Intake',
          data: [2100, 2000, 2200, 2300, 2100, 1900, 2000],
          backgroundColor: 'rgba(255, 99, 132, 0.2)',
          borderColor: 'rgba(255, 99, 132, 1)',
          fill: true,
          tension: 0.1,
          borderWidth: 1
        }]
      },
      options: { scales: { y: { beginAtZero: true } } }
    });
  </script>

  <footer>&copy; 2025 FitTrack. All rights reserved.</footer>
  <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
